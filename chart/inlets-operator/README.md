# inlets-operator chart

The easiest way to install the inlets-operator is with [arkade](https://get-arkade.dev), an open-source Kubernetes marketplace.

See [inlets-operator reference documentation](https://docs.inlets.dev/#/tools/inlets-operator?id=inlets-operator-reference-documentation)

If you would like to use Helm instead, read on.

## Pre-reqs

* Download Helm, i.e. `arkade get helm` or `brew install helm`

* Add the chart repo

  ```sh
  helm repo add inlets https://inlets.github.io/inlets-operator/
  helm repo update
  ```

* Create your access key secret, then apply one of the following configurations.

* Create a secret with an API key generated by DigitalOcean

    ```sh
    kubectl create secret generic inlets-access-key \
    --from-literal inlets-access-key="$(cat ~/Downloads/do-access-token)"
    ```

* Install the CRD:
    Requires Kubernetes 1.16+
    ```sh
    kubectl apply -f ./artifacts/crds
    ```

## Deploy an example configuration

### DigitalOcean

```sh
helm upgrade inlets-operator --install inlets/inlets-operator \
  --set inletsProLicense=LICENSE_VALUE \
  --set region=lon1
```

The `LICENSE_VALUE` will be a code from your Gumroad subscription, or a JWT a static token was purchased.

### Other clouds

See the [reference documentation](https://docs.inlets.dev/#/tools/inlets-operator?id=inlets-operator-reference-documentation)

## Chart parameters

The following table lists the configurable parameters of the `inlets-operator` chart and their default values,
and can be overwritten via the helm `--set` flag.

Parameter | Description | Default
---                             | ---                                                                     | ---
`inletsProLicense`      | The value received for the inlets-pro license                                                 | `""`
`image`                 | Docker image for the inlets-operator                                            | `ghcr.io/inlets/inlets-operator:0.12.0`
`inletsClientImage`           | Docker image for the inlets client                                              | `ghcr.io/inlets/inlets-pro:0.9.1`
`inletsRelease`           |Release version of inlets for tunnel servers                                              | `0.9.1`
`provider`              | Your infrastructure provider - 'digitalocean', 'ec2', 'scaleway', 'equinix-metal', or 'gce'                       | `""`
`region`                | The region to provision hosts into                                              | `""`
`zone`                  | The zone where the exit node is to be provisioned (Used when Google Compute Engine is used as provider) | `us-central1-a`
`vpcId`                 | The VPC ID to create the exit-server in (EC2) | `""`
`subnetId`              | The Subnet ID where the exit-server should be placed (EC2) | `""`
`accessKeyFile`         | Read the access key for your infrastructure provider from a file (recommended)  | `/var/secrets/inlets/inlets-access-key`
`projectID`             | The project ID if using gce or equinix-metal as the provider    | `""`
`annotatedOnly`         | Only create a tunnel for annotated services.                                    | `false`
`resources`             | Operator resources requests & limits                                            | `{"requests":{"cpu": "100m", "memory": "128Mi"}}`
`nodeSelector`          | Node labels for data pod assignment                                             | `{}`
`tolerations`           | Node tolerations                                                                | `[]`
`affinity`              | Node affinity policy                                                            | `{}`
`secretKeyFile`         | If we are using a provider that requires a secret key as well as an access key, set to `/var/secrets/inlets/secret/inlets-secret-key` | `""`
`plan`                  | The plan or size for your cloud instance                                        | different defaults, depending of the infrastructure provider
